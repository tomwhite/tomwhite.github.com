---
layout: post
title: What's new in Apache Whirr 0.5.0-incubating
date: '2011-06-04T23:04:00.017+01:00'
author: Tom White
tags:
- Whirr
- Apache
- Cloud Computing
- Hadoop
modified_time: '2011-06-06T04:50:16.882+01:00'
blogger_id: tag:blogger.com,1999:blog-8898949683610477251.post-7077861757926689669
blogger_orig_url: http://www.tom-e-white.com/2011/06/whats-new-in-apache-whirr-050.html
---

<a href="http://incubator.apache.org/whirr/">Apache Whirr</a> 0.5.0-incubating is <a href="http://www.apache.org/dyn/closer.cgi/incubator/whirr/">now available</a>. Whirr is a library and command line interface for running distributed services like Apache Hadoop in the cloud. Note that Whirr is currently undergoing       Incubation at the Apache Software Foundation, which means that, in particular, the project has yet to be<br />fully endorsed by the ASF. Please read the full <a href="http://svn.apache.org/repos/asf/incubator/whirr/trunk/DISCLAIMER.txt">disclaimer</a>.<br /><br />In this release the <a href="http://incubator.apache.org/whirr/team-list.html">Whirr development team</a> have added many new features while still making the core more solid. This post covers some of the more important changes. The full list can be found in the <a href="http://incubator.apache.org/whirr/release-notes.html">release notes</a>.<br /><br /><h3>Improving the new user experience</h3>Orchestrating multiple services on cloud instances is a challenge to make simple, and Whirr has sometimes been a little fiddly to get running. SSH settings, in particular, have been a common sticking point with new users. The new <a href="http://incubator.apache.org/whirr/whirr-in-5-minutes.html">Whirr in 5 Minutes</a> guide walks through the minimum number of commands you need to type to get a simple 3-node ZooKeeper cluster running in a few minutes. From there you can move on to the <a href="http://incubator.apache.org/whirr/quick-start-guide.html">Quick Start Guide</a> and the <a href="http://incubator.apache.org/whirr/configuration-guide.html">Configuration Guide</a>.<br /><br />The sample configurations in the <i>recipes</i> directory in the distribution contain useful settings for running the services on a variety of cloud providers. Users are always encouraged to share their working configurations with the <a href="http://incubator.apache.org/whirr/mail-lists.html">community</a>.<br /><br /><h3>New services</h3>Elastic Search and Voldemort have been added to the roster of services that come with Whirr. This brings the total to six; adding to Apache Cassandra, Apache Hadoop, Apache HBase, and Apache ZooKeeper.<br /><br /><h3>API improvements</h3>Whirr is still a young project so it is not surprising that its API is rapidly evolving. In <a href="https://issues.apache.org/jira/browse/WHIRR-245">WHIRR-245</a>, the demarcation between the user API (for users who control Whirr clusters from Java) and the service API (for developers writing new Whirr services) was clarified. The user API can be found in the <a href="http://incubator.apache.org/whirr/apidocs/org/apache/whirr/package-summary.html">org.apache.whirr</a> package; whereas the service API is in <a href="http://incubator.apache.org/whirr/apidocs/org/apache/whirr/service/package-summary.html">org.apache.whirr.service</a>.<br /><br />You can find out more about writing Whirr services in <a href="https://cwiki.apache.org/confluence/download/attachments/25199475/how-to-write-a-whirr-service.pdf?version=1&amp;modificationDate=1301953266000">this presentation</a> (PDF).<br /><br />The firewall API that service writers use to open ports for services was simplified and made more powerful in <a href="https://issues.apache.org/jira/browse/WHIRR-275">WHIRR-275</a>.<br /><br /><h3>Overriding scripts</h3>This feature was actually introduced in Whirr 0.4.0-incubating, but it's useful enough to mention here. In older versions of Whirr, if you wanted to make a modification to the scripts that run on cloud instances - to tweak some settings, for instance - you would have to upload your modifications (as well as all the other scripts) to a publicly available web server (Amazon S3 was a common choice), then point Whirr at the new location. Not particularly difficult, but a big enough barrier to discourage users from trying it.<br /><br />The new approach is to push scripts to nodes from the launching machine, so you can just edit them locally before launch. Full instructions are covered in the <a href="http://incubator.apache.org/whirr/faq.html#How_can_I_modify_the_instance_installation_and_configuration_scripts">FAQ</a>.<br /><br /><h3>Running scripts on nodes<br /></h3>In 0.5.0 the scripts that run on cloud instances have been broken up to be more fine-grained, so many services have individual start and stop scripts (<a href="https://issues.apache.org/jira/browse/WHIRR-266">WHIRR-266</a>). Combined with the ability to run scripts on  sets of nodes in the cluster (by ID or role), users now have more control of the cluster once it has launched (<a href="https://issues.apache.org/jira/browse/WHIRR-173">WHIRR-173</a>). Try running <code>whirr run-script</code> at the command line to use this feature. There's a contrib script to run the <a href="https://github.com/brianfrankcooper/YCSB">Yahoo! Cloud Serving Benchmark</a> (YCSB) against an HBase cluster, which takes advantage of the run-script command (<a href="https://issues.apache.org/jira/browse/WHIRR-287">WHIRR-287</a>).<br /><br />Also useful is <a href="https://issues.apache.org/jira/browse/WHIRR-291">WHIRR-291</a>, which allows you to launch "blank" nodes with no services running on them (in a "noop" role), and then, with <code>whirr run-script</code>, run arbitrary scripts on them to bring them into the state you want.<br /><br /><h3>Custom service builds</h3>Developers who work on services supported in Whirr will find the ability to push a custom build to a cluster very useful for testing (<a href="https://issues.apache.org/jira/browse/WHIRR-220">WHIRR-220</a>). For example, if you are working on a ZooKeeper feature, you can build a ZooKeeper tarball with your new feature, then launch a cluster that uses this tarball by specifying <code>whirr.zookeeper.tarball.url</code> as a local <i>file://</i> URL pointing to your tarball. Whirr will push the tarball to a temporary blob store container, then each node will download from there.<br /><br />I used a variation of this feature to try out a <a href="https://builds.apache.org/job/Hadoop-22-Build/">nightly Hadoop 0.22 build</a> on a small Whirr cluster. In this case the tarball URL is not a local file, so Whirr doesn't copy the tarball to a blob store since it is already accessible from the cloud.<br /><br /><h3>Service improvements</h3>Whirr is only able to exist because of the powerful abstraction that <a href="http://code.google.com/p/jclouds/">jclouds</a> provides for interacting with cloud providers. A great example of this power is the API that jclouds provides for discovering the hardware capabilities of an instance running on any provider. <a href="https://issues.apache.org/jira/browse/WHIRR-282">WHIRR-282</a> took advantage of the jclouds API to find the number of cores on a node to dynamically configure the number of slots in a Hadoop cluster. Previously, you had to set this manually for each cluster to take full advantage of larger image sizes.<br /><br />This is just the beginning - there is more work to use memory capabilities to set configuration (<a href="https://issues.apache.org/jira/browse/WHIRR-229">WHIRR-229</a>), and to use hardware capabilities generally in services other than Hadoop.<br /><br /><h3>Cluster state storage</h3>In previous releases of Whirr, information about launched instances was stored in a file on the machine that launched the cluster (<i>~/.whirr/&lt;cluster-name&gt;/instances</i>). With <a href="https://issues.apache.org/jira/browse/WHIRR-288">WHIRR-288</a>, it's now possible to store this information in a blob store instead (such as Amazon S3, although any jclouds-supported blob store can be used), which is useful if you want to control clusters from multiple machines.<br /><br /><h3>Bring Your Own Nodes</h3>Or just BYON, for short. Many users have requested the ability to deploy to privately owned hardware - and jclouds added this feature in 1.0-beta-9. Whirr now has preliminary support for BYON clusters. In a nutshell, you write a YAML file enumerating the nodes to deploy to - their addresses, access credentials, etc. - then Whirr will start services on them. The nodes just need to have a base OS like Centos or Ubuntu installed. You can find an example BYON configuration in the <i>recipes</i> directory of the download.<br /><br />BYON is also useful for testing locally by using VMware or VirtualBox to host target nodes.<br /><br /><h3>A hummingbird</h3><a onblur="try {parent.deselectBloggerImageGracefully();} catch(e) {}" href="{{ site.url }}/assets/2011-06-04-image-0000.png"><img style="margin: 0pt 10px 10px 0pt; float: right; cursor: pointer; width: 247px; height: 260px;" src="{{ site.url }}/assets/2011-06-04-image-0000.png" alt="" border="0" /></a><br />Last, but not least, Whirr finally has a logo! Many thanks to Alison Wong, who designed it and donated it to the ASF.<br /><br /><h3>Credits</h3>I would like to thank everyone who helped with the 0.5.0-incubating release. We have a growing community, and we welcome feedback and help from new users and developers. If you'd like to get involved you can start by <a href="http://www.apache.org/dyn/closer.cgi/incubator/whirr/">downloading the new release</a> and joining us on the <a href="http://incubator.apache.org/whirr/mail-lists.html">mailing lists</a>.<br /><br /><h3>What's next?</h3>It's difficult to make firm predictions about the contents of the next release since Whirr is an open source project with many <a href="https://issues.apache.org/jira/secure/IssueNavigator.jspa?reset=true&amp;jqlQuery=project+%3D+WHIRR+AND+resolution+%3D+Unresolved">open issues</a>, but the general themes include:<br /><ul><li>Adding <a href="https://issues.apache.org/jira/secure/IssueNavigator.jspa?reset=true&amp;jqlQuery=project+%3D+WHIRR+AND+component+%3D+%22new+service%22+and+resolution+%3D+Unresolved">more services</a>. In tandem, we want to make it easier to write new services by pushing common patterns into the core (e.g. <a href="https://issues.apache.org/jira/browse/WHIRR-326">WHIRR-326</a> is one example of this).</li><li>Improving existing services. By making them more flexible, better configured, easier to manage.</li><li>Adding <a href="https://issues.apache.org/jira/secure/IssueNavigator.jspa?reset=true&amp;jqlQuery=project+%3D+WHIRR+AND+component+%3D+%22new+provider%22+and+resolution+%3D+Unresolved">more cloud providers</a>. The latest release of jclouds supports 30 providers, and we need help testing more of them with Whirr.</li><li>Implementing services using other configuration management tools, rather than bash scripting. Andrei Savu is working on using Puppet to write new services (<a href="https://issues.apache.org/jira/browse/WHIRR-255">WHIRR-255</a>).</li><li>Supporting elastic clusters, so new nodes can be added to running clusters (<a href="https://issues.apache.org/jira/browse/WHIRR-214">WHIRR-214</a>).<br /></li></ul>