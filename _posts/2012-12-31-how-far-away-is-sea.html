---
layout: post
title: How far away is the sea?
date: '2012-12-31T16:06:00.000Z'
author: Tom White
tags: 
modified_time: '2012-12-31T16:06:08.382Z'
thumbnail: http://4.bp.blogspot.com/-epoJi4Fc_t0/UOGfMOSFluI/AAAAAAAAAK4/1zRh_2FyrJ8/s72-c/how-far-away-is-the-sea.gif
blogger_id: tag:blogger.com,1999:blog-8898949683610477251.post-5000894151668084463
blogger_orig_url: http://www.tom-e-white.com/2012/12/how-far-away-is-sea.html
---

I wanted an app to answer this question, so I wrote one:<br /><br /><div class="separator" style="clear: both; text-align: center;"><a href="{{ site.url }}/assets/2012-12-31-image-0000.gif" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="{{ site.url }}/assets/2012-12-31-image-0000.gif" /></a></div><br /><br />You can try it out at&nbsp;<a href="http://how-far-away-is-the-sea.appspot.com/">http://how-far-away-is-the-sea.appspot.com/</a>. It works well on phones too, so you can use it when you are out and about.<br /><br /><h3>How does it work?</h3>I used the <a href="http://www.naturalearthdata.com/downloads/10m-physical-vectors/">dataset of land polygons</a> from <a href="http://www.naturalearthdata.com/">Natural Earth</a>, which as the name suggests covers the whole world. The scale is 1:10 million, so inevitably there is some inaccuracy near the coast, particularly where it's wiggly.<br /><br />The app uses your current location (or a location you selected by clicking on the map) and computes the closest point in the set of land polygons. This calculation is performed using the <a href="http://www.vividsolutions.com/jts/JTSHome.htm">JTS Topology Suite</a>, a library for 2D spatial work, and it runs as a Java webapp hosted on Google App Engine.<br /><br />Originally I used <a href="http://www.geotools.org/">Geotools</a> to perform the geospatial calculations, but unfortunately it doesn't run on GAE, so I wrote an offline tool to convert the Natural Earth shapefiles to a <a href="http://www.vividsolutions.com/jts/javadoc/com/vividsolutions/jts/io/WKBWriter.html">JTS binary format</a>. JTS works fine on GAE, but it lacks a distance calculator. Luckily <a href="https://github.com/spatial4j/spatial4j">spatial4j</a> has the requisite distance functions, and it too works on GAE.<br /><br />The webapp exposes a simple query endpoint, so a request for the following URL, for example:<br /><br /><i>http://how-far-away-is-the-sea.appspot.com/query?lat=51.856479&amp;lng=-3.13551</i><br /><br />will return a JSON document with the closest point on the coast, whether the (origin) location is on land or at sea, and the distance in metres to the coast:<br /><br /><pre style="white-space: pre-wrap; word-wrap: break-word;">{</pre><pre style="white-space: pre-wrap; word-wrap: break-word;">"latitude":51.856479,</pre><pre style="white-space: pre-wrap; word-wrap: break-word;">"longitude":-3.13551,</pre><pre style="white-space: pre-wrap; word-wrap: break-word;">"coastLatitude":51.55853913000007,</pre><pre style="white-space: pre-wrap; word-wrap: break-word;">"coastLongitude":-2.984038865999878,</pre><pre style="white-space: pre-wrap; word-wrap: break-word;">"onLand":true,</pre><pre style="white-space: pre-wrap; word-wrap: break-word;">"distanceToCoast":34734.59501052392</pre><pre style="white-space: pre-wrap; word-wrap: break-word;">}</pre><br />The page that the user sees is a simple static HTML page that uses the Google Maps API (v3) to render the map and the markers, and jQuery to query the Java webapp.<br /><br />The complete source code is on Github at&nbsp;<a href="https://github.com/tomwhite/how-far-away-is-the-sea">https://github.com/tomwhite/how-far-away-is-the-sea</a>.<br /><br /><h3>Further ideas</h3>Some of the polygons are a poor approximation to the coastline, so it would be nice to get a higher-resolution dataset. There are likely many potential sources, such as <a href="http://cdu.mimas.ac.uk/2011/data/boundary-data/index.html">this one</a> for the UK.<br /><br />It would be interesting to use the dataset to answer the question: "which is the furthest point from the sea [in the UK/in X/in the world]?". I'd like to find time to do that sometime. Adding in spatial indexes might be helpful too.<br /><br /><h3>If you liked this app then you might like...</h3><a href="https://github.com/tomwhite/isitdayornight">Is it day or night?</a><br /><br /><br />